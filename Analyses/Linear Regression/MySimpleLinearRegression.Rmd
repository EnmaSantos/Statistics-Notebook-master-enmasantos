---
title: "Simple Linear Regression"
output: 
  html_document:
    theme: cerulean
    code_folding: hide
---

```{r, message=FALSE, warning=FALSE}
# Load your libraries
library(pander)
library(car)
library(DT)
library(mosaic)
library(tidyverse)
library(readr)
```


<!-- Directions

Come up with a simple linear regression of your own creation. 

* Write the Background and clearly state your question. Then collect data and perform the linear regression analysis in order to answer your question. Use the proper order of first, ask the question, then second, figure out the answer.

* You should collect both the quantitative response variable and the quantitative explanatory variable yourself. This can be data you collect from 
    - the internet (like weather data, Facebook data, or sports data) 
    - your own experiment 
    - your own observational study
* However,     
    - The data should not be a single pre-existing dataset. It must be something that you piece together yourself.

* You need at least $n=3$ $(X,Y)$ pairs to perform the regression. However, your regression will only be useful if you can get around $n=10$ or more observations.

-->


## Background

FromSoftware, the Japanese development studio, is famous for creating the "Souls-like" genre, known for its high difficulty and intricate world-building. Games like *Dark Souls*, *Bloodborne*, and *Elden Ring* have achieved both critical and commercial success.

This analysis seeks to answer the following question: **Is there a linear relationship between the length of a FromSoftware game and its critical reception?**

One might hypothesize that longer games (like *Elden Ring*) are seen as more "epic" and thus receive higher scores. Conversely, one could also argue that shorter, more focused games (like *Sekiro*) are more polished and are rewarded just as highly.

To investigate this, data was collected manually from two sources:

-   The explanatory variable (X) is the average hours to complete the "Main Story," sourced from `HowLongToBeat.com`.
-   The response variable (Y) is the official critic score, sourced from `Metacritic.com`.

The dataset includes 9 FromSoftware games released between 2009 and 2023, spanning various platforms (PC, PS3, PS4, PS5).
## Analysis

This analysis attempts to model the Metacritic score of FromSoftware games based on the average hours to complete the main story using a simple linear regression. The model can be expressed as:

$$
  \underbrace{Y_i}_\text{Metacritic Score} = \beta_0 + \beta_1 \underbrace{X_i}_\text{Hours to Complete} + \epsilon_i \quad \text{where} \ \epsilon_i \sim N(0, \sigma^2)
$$

The hypotheses for this study concern the slope of the regression model, $\beta_1$. If the slope is zero, then there is no meaningful relationship between the average Metacritic score and the game length.

$$
  H_0: \beta_1 = 0 \quad \text{(Game length does not affect Metacritic score)}
$$
$$
  H_a: \beta_1 \neq 0 \quad \text{(Game length does affect Metacritic score)}
$$
$$
  \alpha = 0.05
$$

```{r, message=FALSE}
# Load the data
game_data <- read_csv("fromsoftware_data.csv")

# Create the linear model
souls_model <- lm(`Puntuacion_Metacritic (Y)` ~ `Horas_HLTB (X)`, data = game_data)

# Create the scatterplot
plot(`Puntuacion_Metacritic (Y)` ~ `Horas_HLTB (X)`, data = game_data, 
     pch = 20, col = "darkblue", cex = 1.5, las = 1,
     xlab = "Hours to Complete Main Story (HLTB)", 
     ylab = "Metacritic Critic Score",
     main = "FromSoftware Games: Length vs. Critical Reception")
mtext(side = 3, text = "Does a longer game receive higher critical praise?", cex = 0.8, line = 0.5)

# Add the regression line
abline(souls_model, lwd = 2, col = rgb(0.8, 0.1, 0.1, 0.5))

# Add grid lines for reference
abline(h = seq(85, 95, 5), v = seq(15, 60, 5), lty = 2, col = rgb(0.2, 0.2, 0.2, 0.2))
```

The scatterplot above shows the relationship between game length (in hours) and Metacritic scores for 9 FromSoftware titles. While there appears to be a slight upward trend, the relationship is not particularly strong, as indicated by the wide dispersion of points around the regression line.

The equation of the estimated regression line from the scatterplot above is:

$$
  \underbrace{\hat{Y}_i}_\text{Est. Metacritic Score} = 86.54 + 0.11 \underbrace{X_i}_\text{Hours to Complete}
$$

This equation suggests that for every additional hour of gameplay, the average Metacritic score increases by approximately 0.11 points. However, we must examine whether this relationship is statistically significant.

**Summary of the Regression**

```{r}
pander(summary(souls_model))
```

The regression analysis reveals that the slope coefficient is 0.11, meaning that for each additional hour of gameplay, we expect the Metacritic score to increase by 0.11 points on average. However, the p-value for the slope is **0.308**, which is much greater than our significance level of $\alpha = 0.05$. This means we **fail to reject the null hypothesis** and conclude that there is not sufficient evidence to claim a statistically significant linear relationship between game length and Metacritic score.

Additionally, the $R^2$ value of **0.1474** indicates that only **14.74%** of the variation in Metacritic scores can be explained by game length. This is a weak relationship, suggesting that other factors—such as gameplay mechanics, story quality, graphics, technical performance, and innovation—play a much larger role in determining critical reception.

## Interpretation

The results of this analysis indicate that **game length is not a significant predictor of critical acclaim** for FromSoftware titles. While longer games like *Elden Ring* (55 hours) and *Dark Souls* (43 hours) have received excellent scores (94 and 85, respectively), shorter games like *Sekiro* (29.5 hours) and the *Demon's Souls Remake* (24.5 hours) have also achieved high scores (90 and 92, respectively).

This suggests that FromSoftware's critical success is not driven by simply making games longer, but rather by the quality of the experience regardless of length. Critics appear to value the tight design, innovative gameplay, and artistic vision that FromSoftware brings to each title, whether the game takes 16 hours (*Armored Core 6*) or 55 hours (*Elden Ring*) to complete.

The baseline intercept of 86.54 indicates that even a hypothetical FromSoftware game with zero hours of content would be expected to score around 87—though this extrapolation is not meaningful. What this really tells us is that FromSoftware games consistently score in the high 80s to low 90s range on Metacritic, regardless of their length.

## Validation of Model Appropriateness

To assess whether the linear regression model is appropriate for this data, we examine the residual plots below. These diagnostic plots help us verify the assumptions of linear regression: linearity, constant variance (homoscedasticity), and normality of residuals.

```{r, fig.height=3}
par(mfrow = c(1, 3))

# Residuals vs Fitted Values (checks linearity and constant variance)
plot(souls_model, which = 1)

# Normal Q-Q Plot (checks normality of residuals)
qqPlot(souls_model$residuals, id = FALSE, main = "Normal Q-Q Plot", ylab = "Residuals")

# Residuals vs Order (checks for independence)
plot(souls_model$residuals, main = "Residuals vs Order", 
     xlab = "Observation Order", ylab = "Residuals")
abline(h = 0, lty = 2, col = "gray")
```

**Assessment of Model Assumptions:**

- **Linearity:** The Residuals vs Fitted plot shows no clear pattern, suggesting that the linear model is appropriate. The red line is relatively flat, indicating that a linear relationship is reasonable.

- **Constant Variance:** The vertical spread of residuals appears relatively consistent across all fitted values, suggesting that the assumption of constant variance is met.

- **Normality:** The Normal Q-Q plot shows that the residuals generally follow a normal distribution, with all points falling close to the diagonal line. This indicates that the normality assumption is satisfied.

- **Independence:** The Residuals vs Order plot shows no obvious pattern or trend, suggesting that the residuals are independent and not correlated with the order of observations.

Overall, the diagnostic plots suggest that the linear regression model is appropriate for this data, even though the relationship between game length and Metacritic score is not statistically significant.

## Conclusion

This analysis sought to determine if a statistically significant linear relationship exists between the length of a FromSoftware game's main story (in hours) and its professional Metacritic score.

The results from the simple linear regression model show that **no statistically significant relationship exists** (p-value = 0.308). We fail to reject the null hypothesis at the $\alpha = 0.05$ significance level and conclude that game length is not a significant predictor of a game's Metacritic score.

The low $R^2$ value of **14.74%** indicates that the vast majority of variation in Metacritic scores is explained by factors other than game length, such as gameplay mechanics, story quality, graphics, technical performance, and overall design philosophy.

In summary, while the data showed a slight positive trend, the statistical analysis confirms that **for FromSoftware games, a longer playtime does not equate to a higher critical review score**. Quality, not quantity, appears to be the determining factor in critical acclaim.

## The Data

For reference, here is the complete dataset used in this analysis:

```{r}
datatable(game_data, options = list(pageLength = 10))
```

